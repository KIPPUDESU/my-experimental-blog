import{u as L}from"./useArticleStore-Bd_87v6D.js";import{u as T}from"./useCommentStore-BU5xzKRj.js";import{d as E,i as v,h as j,c as k,k as t,w as o,b as i,u as V,o as x,l as u,g as q,f as z,_ as G}from"./index-D-8WlOe0.js";const H={key:0,style:{"margin-top":"10px"}},J=E({__name:"Admin",setup(K){const s=L(),p=v(!1),_=v(""),w=v(),l=j({title:"",category:"",content:"",cover:""}),g=v(null),b=T();function A(r){b.remove(r)}let f=null;function I(r){const e=r.target.files;if(!e||!e.length)return;const d=e[0],n=new FileReader;n.onload=()=>{l.cover=n.result},n.readAsDataURL(d)}function U(){_.value="新建文章",p.value=!0,f=null,l.title="",l.category="",l.content="",l.cover=""}function $(r){_.value="编辑文章",p.value=!0,f=r.id,l.title=r.title,l.category=r.category,l.content=r.content}function R(){f===null?s.add(l):s.update({id:f,createdAt:s.getById(f).createdAt,...l}),p.value=!1}function B(r){s.remove(r)}return(r,e)=>{const d=i("el-button"),n=i("el-table-column"),N=i("el-divider"),C=i("el-table"),S=i("el-image"),c=i("el-form-item"),y=i("el-input"),D=i("el-form"),F=i("el-dialog");return x(),k("div",null,[t(d,{type:"primary",onClick:e[0]||(e[0]=a=>U())},{default:o(()=>e[7]||(e[7]=[u("新建文章")])),_:1}),t(C,{data:V(s).articles,style:{width:"100%","margin-top":"20px"}},{default:o(()=>[t(n,{prop:"title",label:"标题"}),t(n,{prop:"category",label:"分类"}),t(n,{prop:"createdAt",label:"创建时间"}),t(n,{label:"操作"},{default:o(({row:a})=>[t(d,{type:"text",onClick:m=>$(a)},{default:o(()=>e[8]||(e[8]=[u("编辑")])),_:2},1032,["onClick"]),t(d,{type:"text",color:"danger",onClick:m=>B(a.id)},{default:o(()=>e[9]||(e[9]=[u("删除")])),_:2},1032,["onClick"]),t(N,null,{default:o(()=>e[10]||(e[10]=[u("评论管理")])),_:1}),t(C,{data:V(b).comments,style:{width:"100%","margin-top":"20px"}},{default:o(()=>[t(n,{prop:"articleId",label:"文章 ID",width:"120"}),t(n,{prop:"author",label:"评论人",width:"120"}),t(n,{prop:"content",label:"内容"}),t(n,{prop:"createdAt",label:"时间",width:"160"}),t(n,{label:"操作",width:"100"},{default:o(({row:m})=>[t(d,{type:"text",color:"danger",onClick:M=>A(m.id)},{default:o(()=>e[11]||(e[11]=[u(" 删除 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"])]),_:1})]),_:1},8,["data"]),t(F,{title:_.value,modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=a=>p.value=a)},{footer:o(()=>[t(d,{onClick:e[5]||(e[5]=a=>p.value=!1)},{default:o(()=>e[13]||(e[13]=[u("取消")])),_:1}),t(d,{type:"primary",onClick:R},{default:o(()=>e[14]||(e[14]=[u("保存")])),_:1})]),default:o(()=>[t(D,{ref_key:"formRef",ref:w,model:l,"label-width":"80px"},{default:o(()=>[t(c,{label:"封面 URL",prop:"cover"},{default:o(()=>[t(d,{type:"primary",onClick:e[1]||(e[1]=a=>{var m;return(m=g.value)==null?void 0:m.click()})},{default:o(()=>e[12]||(e[12]=[u("上传封面")])),_:1}),q("input",{ref_key:"fileInput",ref:g,type:"file",accept:"image/*",style:{display:"none"},onChange:I},null,544),l.cover?(x(),k("div",H,[t(S,{src:l.cover,fit:"cover",style:{width:"120px",height:"80px",border:"1px solid #ebeef5"}},null,8,["src"])])):z("",!0)]),_:1}),t(c,{label:"标题"},{default:o(()=>[t(y,{modelValue:l.title,"onUpdate:modelValue":e[2]||(e[2]=a=>l.title=a)},null,8,["modelValue"])]),_:1}),t(c,{label:"分类"},{default:o(()=>[t(y,{modelValue:l.category,"onUpdate:modelValue":e[3]||(e[3]=a=>l.category=a)},null,8,["modelValue"])]),_:1}),t(c,{label:"正文"},{default:o(()=>[t(y,{type:"textarea",modelValue:l.content,"onUpdate:modelValue":e[4]||(e[4]=a=>l.content=a),rows:"6"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}}),W=G(J,[["__scopeId","data-v-be1354f2"]]);export{W as default};
